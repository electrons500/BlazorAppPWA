@page "/Game/AddGame"
@using BlazorAppPWA.Client.Enums
@using BlazorAppPWA.Client.SweetAlert
@using BlazorAppPWA.Shared
@inject HttpClient _client
@inject IJSRuntime js;
@inject NavigationManager navigationManager

<PageTitle>Add Game</PageTitle>
<h3>Add Game</h3>
<br />
<div class="row">
    <div class="col-sm-6">
        <EditForm Model="@game" OnValidSubmit="onSubmithandler">
            <DataAnnotationsValidator />
            <ValidationSummary />
            <div class="mb-3">
                <label class="form-label">Game name</label>
                <InputText class="form-control" @bind-Value="game.GameName"/>
            </div>
             <div class="mb-3">
                <label class="form-label">Price</label>
                <InputNumber class="form-control" @bind-Value="game.Price"/>
            </div>
             <div class="mb-3">
                <label class="form-label">Date Created</label>
                <InputDate class="form-control" @bind-Value="game.CreatedAt"/>
            </div>

            <div class="mb-3">
                <button class="btn btn-primary">Submit</button>
            </div>
        </EditForm>
    </div>
</div>

@code {
    private Game game = new();
    private SweetAlertBase _sweetAlertBase;

    protected override Task OnInitializedAsync()
    {
        _sweetAlertBase = new SweetAlertBase(js);
        return base.OnInitializedAsync();
    }
    private async void onSubmithandler()
    {
        var response = await _client.PostAsJsonAsync<Game>("api/Games/AddGame", game);
        if (response.IsSuccessStatusCode)
        {
            await _sweetAlertBase.DefaultAlertAsync("Congratulations", "You have successfully added the game.", SweetAlertEnum.SweetAlertIconType.success.ToString());
            navigationManager.NavigateTo("/Game");
        }
    }
}
